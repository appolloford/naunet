#ifndef __NAUNET_ODE_H__
#define __NAUNET_ODE_H__

#include <boost/numeric/odeint.hpp>

#include "naunet_macros.h"
#include "naunet_data.h"

typedef boost::numeric::ublas::vector<double> vector_type;
typedef boost::numeric::ublas::matrix<double> matrix_type;

int EvalRates(double *k, double *y, NaunetData *user_data);
#if NHEATPROCS
int EvalHeatingRates(double *kc, double *y, NaunetData *user_data);
#endif
#if NCOOLPROCS
int EvalCoolingRates(double *kc, double *y, NaunetData *user_data);
#endif

class Fex {
   private:
    NaunetData *u_data;

   public:
    Fex(NaunetData *data);
    ~Fex();

    void operator()(const vector_type &abund, vector_type &ydot, double t);
};

class Jac {
   private:
    NaunetData *u_data;

   public:
    Jac(NaunetData *data);
    ~Jac();

    void operator()(const vector_type &abund, matrix_type &j, const double &t,
                    vector_type &dfdt);
};

#endif