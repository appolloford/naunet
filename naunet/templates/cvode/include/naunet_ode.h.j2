#ifndef __NAUNET_ODE_H__
#define __NAUNET_ODE_H__

#include <sundials/sundials_matrix.h>
#include <sundials/sundials_nvector.h>
#include <sundials/sundials_types.h>  // defs. of realtype, sunindextype

#include "naunet_data.h"

/* {% if info.device == "gpu" -%} */
__device__ int EvalRates(realtype *k, realtype *y, NaunetData *user_data);
/* {% else -%} */
int EvalRates(realtype *k, realtype *y, NaunetData *user_data);
/* {% endif -%} */
int Fex(realtype t, N_Vector u, N_Vector udot, void *user_data);
int Jac(realtype t, N_Vector u, N_Vector fu, SUNMatrix jmatrix, void *user_data,
        N_Vector tmp1, N_Vector tmp2, N_Vector tmp3);

/* {% if info.method == "cusparse" -%} */
int InitJac(SUNMatrix jmatrix);
__global__ void FKernel(realtype *y, realtype *ydot, NaunetData *udata,
                        int nsystem);
__global__ void JKernel(realtype *y, realtype *jdata, NaunetData *udata,
                        int nsystem);
/* {% else -%} */
int Jtv(N_Vector v, N_Vector jv, realtype t, N_Vector u, N_Vector fu,
        void *user_data, N_Vector tmp);
/* {% endif -%} */

#endif